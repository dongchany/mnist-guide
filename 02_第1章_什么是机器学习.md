# 第 1 章：什么是机器学习？

> **本章目标**：理解分类问题、训练/测试的概念，认识 MNIST 数据集。
> **预计时间**：1 小时

---

## 1.1 从一个问题开始

假设有人给你一张手写的数字图片，问你："这是几？"

你的大脑瞬间就能回答。但你能写出一套规则来描述"怎样的笔画是 7"吗？非常困难——7 的写法因人而异，有人带横杠，有人不带。

**机器学习的核心思想**：与其人工编写规则，不如让计算机从大量"例子"中自己学习规则。

---

## 1.2 分类问题

我们要解决的是一个**分类问题**：

- **输入**：一张 28×28 像素的灰度图片（每个像素是 0–255 之间的数字）
- **输出**：一个类别标签（0、1、2、……、9 中的一个）
- **目标**：让计算机学会自动判断图片中的数字是什么

这就是所谓的**监督学习**——我们给计算机"带答案的例子"，让它从中学习规律。

---

## 1.3 训练与测试

关键概念：

**训练集（Training Set）**：带有正确答案的图片。计算机用它来"学习"。就像学生做练习题。

**测试集（Test Set）**：也有正确答案，但在学习过程中**不给计算机看**。用来检验计算机是否真正学到了规律，而不是死记硬背。就像学生参加考试——考的是新题。

为什么需要分开？如果用学过的题来评估，一个只会"背答案"的模型也能得满分，但它面对新数据就完全不行。这就是**过拟合**的概念。

---

## 1.4 MNIST 数据集

MNIST 是机器学习领域最经典的入门数据集，由 Yann LeCun 等人整理。

**基本信息**：
- 训练集：60,000 张图片
- 测试集：10,000 张图片
- 每张图片：28 × 28 像素，灰度（单通道）
- 标签：0–9，共 10 个类别

**为什么从 MNIST 开始？** 它足够简单（不需要 GPU 也能训练），但又足够真实（是真人手写的数字），非常适合作为第一个项目。

### 数据长什么样？

每张图片是一个 28×28 的数字矩阵。0 表示纯黑（背景），255 表示纯白（笔画）：

```
          ┌─────────────────────────────┐
          │ 0  0  0  0  0  0  0  0  ... │  ← 第 1 行（全黑，背景）
          │ 0  0  0  0  0  0  0  0  ... │  ← 第 2 行
          │ ...                          │
          │ 0  0  0 50 180 255 200 0 ... │  ← 某一行（出现笔画了！）
          │ ...                          │
          └─────────────────────────────┘
              28 列（28 个像素）
```

### 用代码看看数据

```python
import numpy as np
import matplotlib.pyplot as plt
from data_loader import load_mnist

# Load the dataset
X_train, y_train, X_test, y_test = load_mnist('./MNIST_data')
# X_train.shape: (60000, 28, 28)
# y_train.shape: (60000,)

# Display some samples
fig, axes = plt.subplots(2, 5, figsize=(10, 4))
for i, ax in enumerate(axes.flat):
    ax.imshow(X_train[i], cmap='gray')
    ax.set_title(f'Label: {y_train[i]}')
    ax.axis('off')
plt.tight_layout()
plt.show()
```

### 数据预处理

在喂给神经网络之前，我们需要做两步处理：

**1. 归一化**：把像素值从 [0, 255] 缩放到 [0, 1]。这样做的原因是：数值太大会导致计算不稳定。

```python
X_train = X_train.astype(np.float64) / 255.0
```

**2. 展平**：对于全连接网络，需要把 28×28 的二维图片拉成 784 维的一维向量。

```python
X_train_flat = X_train.reshape(60000, 784)   # (60000, 28, 28) → (60000, 784)
```

**直觉**：你可以把每张图片想象成一个有 784 个特征的数据点。每个特征就是一个像素的亮度。

---

## 1.5 我们的目标

建一个"函数" f，使得：

```
f(一张图片) → 数字类别
```

比如：
```
f(🖼️手写的3) → 3
f(🖼️手写的7) → 7
```

这个函数 f 就是我们的**神经网络**。它有一堆可调参数（叫做"权重"），我们通过训练数据来找到好的参数值，让 f 尽可能地"猜对"。

下一章，我们从最简单的构建块——单个神经元——开始。

---

## 1.6 动手练习

**练习 1**：加载 MNIST 数据，打印训练集和测试集的 shape。每个类别有多少张训练图片？（提示：用 `np.bincount`）

**练习 2**：随机挑选一张图片，用 `print` 输出它的像素矩阵。观察哪些位置的数值较大，是否对应了笔画？

**练习 3**：思考题——如果我们只用每张图片的"平均亮度"（所有像素的均值）来分类，你觉得效果会怎样？为什么？
